{% from "header.html" import header %}
{% extends "base.html" %}

{% block title %}settings{% endblock %}
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', path='settings_style.css') }}">
{% endblock %}


{% block body %}
{{ header(request, username, access_level, "settings") }}
<div id="settings_container">
	<div id="settings_nav">
		<div id="settings" class="settings_section"><a href="#settings">Account Settings</a>
			<div class="collapsed">
				<div>
					<span>Username: {{ username }}</span> <button onclick="document.getElementById('username_change').showModal()">Change</button>
				</div>
				<div><button onclick="document.getElementById('password_change').showModal()">Change password</button></div>
			</div>
		</div>
		<div id="shares" class="settings_section"><a href="#shares">Share links</a>
			<div class="collapsed">
				<div>Your shares</div>
			</div>
		</div>
	</div>
</div>

<dialog id="loading_dialog">
	<div>loading...</div>
</dialog>

<dialog id="username_change">
	<form method="dialog" id="username_change_form" onsubmit="change_username();">
		<div>
			<label for="new_username">New username:</label>
			<input id="new_username" name="new_username" autocomplete="off" type="text">
		</div>
		<input type="submit" value="Change">
	</form>
</dialog>

<dialog id="password_change">
	<form method="dialog" id="password_change_form" onsubmit="change_password();">
		<div class="error" id="password_change_message"></div>
		<div>
			<label for="old_password">Current password:</label>
			<input id="old_password" name="old_password" autocomplete="off" type="password">
		</div>
		<div>
			<label for="new_password">New password:</label>
			<input id="new_password" name="new_password" autocomplete="new-password" type="password" required>
		</div>
		<div>
			<label for="confirm_new_password">Confirm new password:</label>
			<input id="confirm_new_password" name="confirm_new_password" autocomplete="new-password" type="password" required>
		</div>
		<div><input type="submit" value="Change"> <input type="button" value="Cancel" onclick="document.getElementById('password_change').close();"></div>
	</form>
</dialog>
{% endblock %}


{% block scripts %}
<script type="text/javascript">
	var PASSWORD_CHANGE_URL = "{{ url_for('change_password') }}";
</script>
<script type="text/javascript" src="{{ url_for('static', path='settings.js') }}"></script>
{% endblock %}
